{# SPDX-License-Identifier: AGPL-3.0-or-later #}
{% load static %}
{% load django_bootstrap5 %}
<!DOCTYPE html>
<html lang="en" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-dark-5@1.1.3/dist/css/bootstrap-nightshade.min.css"
        rel="stylesheet">
    <link rel="icon" type="image/png" href="{% static 'browser/logo.png' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'browser/style.css' %}">
    <style>
        :root {
            --surface: #ffffff;
            --surface-2: #f5f7fb;
            --text: #2a2e37;
            --muted: #6b7280;
            --brand: #4f46e5;
            --brand-2: #6366f1;
            --border: #e5e7eb;
            --shadow: 0 6px 20px rgba(0,0,0,.08);
            --rainbow: conic-gradient(from 0deg at 50% 50%, #ff6b6b, #f59e0b, #f7d045, #34d399, #60a5fa, #a78bfa, #f472b6, #ff6b6b);
        }

        html.dark :root, html.dark {
            --surface: #15181e;
            --surface-2: #1b2028;
            --text: #e5e7eb;
            --muted: #9aa4b2;
            --brand: #8b8ff7;
            --brand-2: #a1a6ff;
            --border: #2b313b;
            --shadow: 0 6px 20px rgba(0,0,0,.35);
            --rainbow: conic-gradient(from 0deg at 50% 50%, #ff6b6b, #f59e0b, #f7d045, #34d399, #60a5fa, #a78bfa, #f472b6, #ff6b6b);
        }

        body {
            background: linear-gradient(180deg, var(--surface-2), var(--surface));
            color: var(--text);
        }

        /* Top navigation */
        .app-navbar {
            border-radius: 16px;
            background: linear-gradient(180deg, color-mix(in oklab, var(--surface) 85%, var(--surface-2)), var(--surface)) !important;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            margin: 14px auto 18px;
            position: relative;
            overflow: hidden;
        }
        .app-navbar:before {
            content: "";
            position: absolute;
            inset: 0;
            background: radial-gradient(1200px 120px at -10% 0%, rgba(99,102,241,.12), transparent 60%),
                        radial-gradient(1200px 120px at 110% 0%, rgba(99,102,241,.12), transparent 60%);
            pointer-events: none;
        }
        .navbar-brand {
            font-weight: 700;
            letter-spacing: .2px;
        }
        .navbar .btn-primary, .btn-primary {
            background: var(--brand);
            border-color: var(--brand);
        }
        .navbar .btn-primary:hover, .btn-primary:hover {
            background: var(--brand-2);
            border-color: var(--brand-2);
        }

        /* Sections */
        .page-section {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 14px;
            box-shadow: var(--shadow);
            padding: 16px 18px;
            margin-bottom: 18px;
            transition: transform .25s ease, box-shadow .25s ease, border-color .25s ease;
        }
        .page-section:hover {
            transform: none;
            box-shadow: var(--shadow);
            border-color: color-mix(in oklab, var(--brand) 40%, var(--border));
        }
        .glass { backdrop-filter: saturate(140%) blur(10px); background: color-mix(in oklab, var(--surface) 88%, transparent); }
        .glass-sm { backdrop-filter: saturate(140%) blur(6px); }
        .glow-border { box-shadow: var(--shadow); position: relative; }
        .glow-border:hover {
            border: 1px solid transparent;
            background: linear-gradient(var(--surface), var(--surface)) padding-box, var(--rainbow) border-box;
        }
        .section-title {
            font-size: 1.05rem;
            font-weight: 700;
            margin: 4px 0 14px;
            letter-spacing: .02em;
        }

        /* Search toolbar */
        .search-toolbar {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
        }
        @media (max-width: 992px) {
            .search-toolbar { grid-template-columns: repeat(2, 1fr); }
        }
        @media (max-width: 576px) {
            .search-toolbar { grid-template-columns: 1fr; }
        }
        .search-card { background: var(--surface-2); border: 1px solid var(--border); border-radius: 12px; padding: 12px; }
        .search-card:hover { transform: none; box-shadow: none; border-color: color-mix(in oklab, var(--brand) 40%, var(--border)); background: linear-gradient(180deg, var(--surface), var(--surface-2)); }
        .search-card label {
            font-size: .78rem;
            text-transform: uppercase;
            color: var(--muted);
            margin-bottom: 6px;
            letter-spacing: .06em;
            transition: color .2s ease;
        }
        .search-card:hover label { color: var(--text); }
        .search-card .form-control {
            border-radius: 10px;
            height: 42px;
            background: color-mix(in oklab, var(--surface-2) 92%, var(--surface));
            border-color: var(--border);
            transition: background .2s ease, border-color .2s ease, box-shadow .2s ease;
        }
        .search-card .btn { width: 100%; }

        /* Generic forms highlight inside sections */
        .page-section form .form-control { background: color-mix(in oklab, var(--surface-2) 92%, var(--surface)); border-color: var(--border); transition: background .2s ease, border-color .2s ease, box-shadow .2s ease; }
        .page-section form .form-control:hover, .page-section form .form-control:focus { background: var(--surface); border-color: var(--brand); box-shadow: 0 0 0 2px rgba(99,102,241,.2); }

        /* Table enhancements */
        .table-container {
            border-radius: 14px;
            overflow: hidden;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            background: var(--surface);

        }
        .table-container:hover { transform: none; box-shadow: var(--shadow); border: 1px solid transparent; background: linear-gradient(var(--surface), var(--surface)) padding-box, var(--rainbow) border-box; }
        table.modern-table thead th {
            position: sticky;
            top: 0;
            z-index: 2;
            background: var(--surface);
            background-image: linear-gradient(180deg, color-mix(in oklab, var(--surface) 70%, var(--surface-2)), var(--surface));
            border-bottom: 1px solid var(--border);
            text-transform: none;
        }
        table.modern-table tbody tr:nth-child(even) td { background: rgba(31, 41, 55, 0.03); }
        html.dark table.modern-table tbody tr:nth-child(even) td { background: rgba(255, 255, 255, 0.03); }
        table.modern-table tbody tr:hover td { background: rgba(99, 102, 241, 0.08); transition: background .2s ease; }
        table.modern-table td, table.modern-table th { vertical-align: middle; }

        /* UUID / UserID / Username cells: compact, up to two lines */
        textarea.uuid,
        textarea.userid,
        textarea[name="Username"] {
            resize: none;
            overflow: hidden;
            white-space: normal;
            word-break: break-all;
            background: var(--surface-2);
            border: 1px solid var(--border);
            border-radius: 10px;
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            font-size: .9rem;
            line-height: 1.2rem;
            height: calc(1.2rem * 2 + 12px);
            padding: 6px 10px;
            box-shadow: none;
        }
        textarea.uuid { width: 13rem; max-width: 100%; }
        textarea.userid { width: 10rem; max-width: 100%; }
        textarea[name="Username"] { width: 12rem; max-width: 100%; }

        .modern-table .clip {
            color: var(--muted);
            border-radius: 8px;
            padding: 0 6px;
            line-height: 1;
        }
        .modern-table .clip:hover {
            color: var(--brand);
            background: rgba(99,102,241,.12);
        }

        /* List sections */
        .page-section .list-group { --bs-list-group-bg: transparent; }
        .page-section .list-group-item { background: transparent; border-color: var(--border); border-radius: 10px; margin-right: 8px; }
        .page-section .list-group-item + .list-group-item { margin-left: 0; }

        /* Buttons */
        .btn-primary { position: relative; overflow: hidden; }
        .btn-primary::after {
            content: ""; position: absolute; inset: 0; background: radial-gradient(200px 60px at var(--x,50%) -20%, rgba(255,255,255,.25), transparent 60%);
            opacity: 0; transition: opacity .25s ease;
        }
        .btn-primary:hover::after { opacity: 1; }

        /* Search button: cursor-follow glow */
        .search-card .btn-primary {
            position: relative;
            isolation: isolate; /* keep pseudo-element behind text */
            --glow-x: 50%;
            --glow-y: 50%;
            background: linear-gradient(135deg, var(--brand), var(--brand-2));
            border: 1px solid transparent;
            border-radius: 10px;
            transition: box-shadow .25s ease, filter .25s ease;
        }
        .search-card .btn-primary::before {
            content: "";
            position: absolute;
            inset: -2px;
            border-radius: inherit;
            pointer-events: none;
            z-index: 0;
            background:
                radial-gradient(160px 160px at var(--glow-x) var(--glow-y), rgba(99,102,241,.35), transparent 60%),
                radial-gradient(300px 300px at var(--glow-x) var(--glow-y), rgba(99,102,241,.18), transparent 70%);
            opacity: 0;
            transition: opacity .18s ease;
        }
        .search-card .btn-primary:hover::before { opacity: 1; }
        .search-card .btn-primary:hover { box-shadow: 0 0 0 2px rgba(99,102,241,.25), 0 10px 26px rgba(99,102,241,.22); filter: saturate(116%) brightness(1.03); }

        /* Small accent animation for icons */
        @keyframes pulse-fade { 0% { opacity: .45; } 50% { opacity: .9; } 100% { opacity: .45; } }
        .muted-pulse { animation: pulse-fade 2.6s ease-in-out infinite; }

        /* Footer */
        .app-footer {
            color: var(--muted);
            font-size: .9rem;
        }
    </style>
    {% block head %}
    {% endblock head %}
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <div class="col">
                <nav class="navbar navbar-expand-lg navbar-light bg-light app-navbar">
                    <div class="container-fluid">
                        <a class="navbar-brand d-flex align-items-center ms-2" href="/">
                            <div class="flex-shrink-0">
                                <img src="{% static 'browser/logo.png' %}" alt="Logo">
                            </div>
                            <div class="flex-grow-1 ms-1">
                                BSB Browser
                            </div>
                        </a>
                        <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                            data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false"
                            aria-label="Toggle navigation">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                        <div class="collapse navbar-collapse" id="navbarNav">
                            <div class="navbar-nav">
                                <a class="nav-link active pb-1" aria-current="page"
                                    href="https://bsbsb.top/database.zip" target="_blank">下载数据库</a>
                            </div>
                        </div>
                        <button class="btn btn-secondary me-2" id="darkmode"
                            title="Dark mode toggle">暗色/亮色模式</button>
                    </div>
                </nav>
            </div>
        </div>
        {% block body %}
        {% endblock %}
        <div class="row">
            <div class="col">
                <div class="page-section app-footer">
                    数据更新时间（北京时间）{{ updated }}
                </div>
            </div>
            <div class="col-auto">
                <div class="page-section app-footer">
                    <a href="https://github.com/hanydd/BSBbrowser">BBSBbrowser</a>移植自
                    <a href="https://github.com/Lartza/SBbrowser">SBbrowser</a>，采用 GPLv3开源协议。使用
                    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>
                    协议的<a href="https://bsbsb.top">BilibiliSponsorBlock</a>数据。
                </div>
            </div>
        </div>
    </div>
    {% bootstrap_javascript %}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-dark-5@1.1.3/dist/js/darkmode.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.slim.min.js"></script>
    <script src="{% static 'browser/sbtools.js' %}"></script>
</body>

</html>